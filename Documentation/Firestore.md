# Firestore Database Guide

## 컬렉션 설명

시작점이 되는 컬렉션은 두 종류로 나뉩니다:

- Snippet: Vanilla SwiftUI에서 실행 가능한 코드가 포함된 컬렉션입니다. 파일의 전체 코드가 저장됩니다.
- Feature: 여러 Snippet들로 구성된 커스텀 기능을 나타냅니다. 필요한 Snippet의 정보와 메타데이터가 저장됩니다.

## 데이터베이스 환경 분리

특정 기능의 코드를 가져오려면 Feature를 조회한 후, 해당 Feature를 구성하는 모든 Snippet 코드를 가져옵니다. 그런 다음, 가져온 Snippet 코드들이 Xcode에서 정상적으로 빌드되는지 확인해야 합니다.

따라서 Snippet의 변경 사항이 바로 운영 환경에 적용되는 것은 위험하며, 반드시 테스트 데이터베이스에서 먼저 검증한 후, 문제가 없을 때에만 운영 데이터베이스에 적용됩니다.

## 테스트 데이터베이스 업데이트

Snippet과 Feature의 업데이트 방식은 서로 다릅니다.

- Snippet: PR 시점에서 업데이트가 진행됩니다. Snippet 디렉토리 하위 파일 중 변경된 파일만 PATCH API를 호출하여 업데이트합니다.
- Feature: Feature는 연관된 Snippet들을 json 파일로 관리합니다. 데이터베이스는 이 json 파일을 읽어 필요한 업데이트를 진행합니다.

테스트 데이터베이스는 위 과정을 PR 시점에서 수행합니다.

운영 데이터베이스 업데이트

테스트 데이터베이스에서 문제가 발생하지 않으면, PR이 Merge된 후 동일한 방식으로 운영 데이터베이스를 업데이트합니다.

## 테스트 방식

Feature의 모든 데이터를 읽고, 각 Feature의 코드가 정상적으로 빌드되는지 확인합니다. GitHub Actions를 이용하여 empty.swift 파일에 각 Feature의 모든 코드를 넣어 빌드를 시도합니다.

이 과정을 통해 각 Feature가 Xcode에서 정상적으로 작동하는지 테스트합니다.
